# 泛太總帳系統 - 薪資計算核心邏輯詳解

## 1. 薪資計算基本原則

### 1.1 薪資計算基礎公式

薪資計算基本公式如下：
```
應領薪資 = 基本薪資 + 應稅加項 + 免稅加項 - 應稅減項 - 免稅減項
```

其中：
- **基本薪資**：依據員工薪資級別與計薪天數計算
- **應稅加項**：需納入所得稅計算的加項（如：加班費、獎金等）
- **免稅加項**：免納入所得稅計算的加項（如：部分加班費、特定補助等）
- **應稅減項**：從應稅所得中扣除的項目（如：請假扣薪等）
- **免稅減項**：不影響應稅所得的扣除項目（如：勞健保費、福利金等）

### 1.2 計薪週期與發薪日

- **計薪週期**：每月 1 日至月底
- **發薪日**：下個月 25 日（如遇假日則提前至前一工作日）
- **計薪截止日**：當月 25 日
  - 25 日以後的出勤異動納入下月計算
  - 加班單核准截止日為當月 20 日

## 2. 基本薪資計算

### 2.1 全月在職員工計算

全月在職員工的基本薪資計算公式：
```
基本薪資 = 薪資級別對應金額
```

### 2.2 破月計薪計算

#### 2.2.1 破月到職員工計算

破月到職員工薪資計算公式：
```
基本薪資 = 薪資級別對應金額 × (實際在職天數 ÷ 計薪基數天數)
```

計薪基數天數說明：
- 大小月（31天）：以當月實際天數為基數
- 小月（30天）：以 30 天為基數
- 2月特例：以 30 天為基數（依財務要求）

實際在職天數計算：
```
實際在職天數 = 當月天數 - 到職日 + 1
```

舉例：2月10日到職，計薪基數為30天，實際在職天數為 (30-10+1) = 21天

#### 2.2.2 破月離職員工計算

破月離職員工薪資計算公式：
```
基本薪資 = 薪資級別對應金額 × (實際在職天數 ÷ 計薪基數天數)
```

實際在職天數計算：
```
實際在職天數 = 離職日
```

不論當月是否為大小月，離職員工均以 30 天為基數計算。

#### 2.2.3 計薪天數與請假扣薪特殊處理

- 當月同時有到職又離職者：以離職日減到職日加 1 為實際在職天數
- 當月到職並請假者：先按比例計算應發薪資，再依請假天數扣薪
- 當月離職並請假者：請假天數已反映在實際出勤天數中，不另扣薪

## 3. 加班費計算

### 3.1 加班費計算公式

加班費基本時薪計算：
```
平日加班時薪基數 = 月薪 ÷ 240（或 30 × 8）
```

加班費計算區分為應稅加班與免稅加班：

#### 3.1.1 應稅加班費

```
應稅加班費 = WT_Overtime_小時數 × 加班費時薪基數 × 倍率
```

- 平日前 2 小時：倍率 = 1.33
- 平日後續時數：倍率 = 1.66
- 休息日工作：倍率 = 1.33 或 1.66（依實際情況）
- 例假日工作：倍率 = 2.0

#### 3.1.2 免稅加班費

```
免稅加班費 = NT_Overtime_小時數 × 加班費時薪基數 × 倍率
```

免稅加班時數依據勞基法規定計算，不超過法定免稅額度。

### 3.2 加班費計算特殊規則

- 加班費計算至整數，無條件進位
- 免稅加班費每月累計上限為 46 小時
- 男性主管與間接人員無免稅加班
- 時薪計算保留小數點後兩位

### 3.3 加班費稅率處理

- 應稅加班費併入當月薪資計算所得稅
- 免稅加班費不計入所得稅計算
- 年度結算時將免稅加班費與薪資合併檢視是否超過免稅額度

## 4. 請假扣薪計算

### 4.1 請假扣薪基本原則

請假扣薪基本公式：
```
請假扣薪金額 = 日薪基數 × 請假天數 × 扣薪比例
```

日薪基數計算：
```
日薪基數 = 月薪 ÷ 30
```

### 4.2 各類請假扣薪規則

| 假別         | 扣薪比例 | 備註                       |
|--------------|----------|----------------------------|
| 事假         | 100%     | 全扣                       |
| 病假         | 50%      | 半扣                       |
| 特休假       | 0%       | 不扣薪                     |
| 婚假         | 0%       | 不扣薪                     |
| 喪假         | 0%       | 不扣薪                     |
| 公假         | 0%       | 不扣薪                     |
| 颱風假       | 0%       | 不扣薪                     |
| 產假         | 50%      | 依勞基法規定               |
| 陪產假       | 0%       | 不扣薪                     |
| 家庭照顧假   | 0%       | 不扣薪（但每年以 7 天為限）|
| 無薪假       | 100%     | 全扣                       |

### 4.3 請假時數計算特殊規則

- 半天計算：以 4 小時計
- 請假時數換算天數：時數 ÷ 8 = 天數
- 請假扣薪計算無條件捨去至整數

## 5. 勞健保計算

### 5.1 勞保費計算

勞保費計算公式：
```
勞保費 = 勞保投保薪資 × 勞保費率 × 負擔比例 ÷ 30 × 計費天數
```

- 勞保投保薪資：依據員工薪資級距對應勞保投保級距表
- 勞保費率：依政府公告費率（目前為 11%）
- 個人負擔比例：20%
- 雇主負擔比例：70%
- 政府負擔比例：10%

#### 5.1.1 破月勞保費計算

破月到職者：
```
勞保費 = 勞保投保薪資 × 勞保費率 × 負擔比例 ÷ 30 × (實際在職天數)
```

破月離職者：
```
勞保費 = 勞保投保薪資 × 勞保費率 × 負擔比例 ÷ 30 × (離職日)
```

勞保費計算採四捨五入至整數。

### 5.2 健保費計算

健保費計算公式：
```
健保費 = 健保投保薪資 × 健保費率 × 負擔比例 × (1 + 眷屬人數 × 眷屬負擔比例)
```

- 健保投保薪資：依據員工薪資級距對應健保投保級距表
- 健保費率：依政府公告費率（目前為 5.17%）
- 個人負擔比例：30%
- 雇主負擔比例：60%
- 政府負擔比例：10%
- 眷屬負擔比例：依法定比例（目前每位眷屬以 0.7 計算）

#### 5.2.1 健保費特殊規則

依據健保局確認的現行代扣方式：
1. 當日報到並離職者：健保費個人部份毋需代扣且公司也不必負擔
2. 當月報到當月離職（不含報到當日）且離職日為月底：個人需代扣健保費且公司也需負擔
3. 當月報到當月離職（不含報到當日）且離職日非月底：當月一率不扣
4. 前一個月之前報到，本月份離職：個人部份毋需代扣且公司也不必負擔

## 6. 所得稅計算

### 6.1 薪資所得計算

應稅薪資所得計算公式：
```
應稅薪資所得 = 基本薪資 + 應稅加項 - 應稅減項
```

### 6.2 扣繳稅額計算

扣繳稅額計算公式：
```
扣繳稅額 = 應稅薪資所得 × 扣繳稅率
```

### 6.3 扣繳稅率判定

| 納稅身分 | 條件                       | 扣繳稅率 |
|----------|-----------------------------|----------|
| 境內居住者 | 全月給付總額在「基本工資」以下者 | 免稅    |
| 境內居住者 | 全月給付總額超過「基本工資」者 | 依薪資所得扣繳辦法，按表列扣繳稅率計算 |
| 非境內居住者 | 連續居住天數未滿 183 天 | 18% (固定稅率) |

#### 6.3.1 薪資所得扣繳稅率表

| 薪資所得級距 | 扣繳稅率 |
|--------------|----------|
| 0 至 54,000 元 | 5% |
| 54,001 至 121,500 元 | 12% |
| 121,501 至 242,000 元 | 20% |
| 242,001 元以上 | 30% |

### 6.4 所得稅計算特殊規則

- 外籍人士特殊稅率應用
- 年度所得稅預扣調整機制
- 年中稅率變動處理方式

## 7. 薪資項目明細

### 7.1 薪資加項目錄

| 項目代碼 | 項目名稱 | 稅務屬性 | 計算方式 | 備註 |
|----------|----------|----------|----------|------|
| S01 | 底薪 | 應稅 | 基本薪資計算 | 主要薪資項目 |
| S02 | 職務加給 | 應稅 | 固定金額 | 依職務設定 |
| S03 | 伙食津貼 | 免稅 | 固定金額 | 每月固定發放 |
| S04 | 加班費 | 應稅/免稅 | 依加班時數計算 | 分應稅和免稅兩部分 |
| S05 | 年終獎金 | 應稅 | 依年度考核結果計算 | 年度發放 |
| S06 | 績效獎金 | 應稅 | 依績效評估結果計算 | 視營運狀況發放 |
| S07 | 值班津貼 | 應稅 | 固定金額/次 | 依實際值班次數計算 |
| S08 | 交通津貼 | 免稅 | 固定金額 | 每月固定發放 |

### 7.2 薪資減項目錄

| 項目代碼 | 項目名稱 | 稅務屬性 | 計算方式 | 備註 |
|----------|----------|----------|----------|------|
| D01 | 勞保費 | 免稅減項 | 依勞保計算規則 | 個人負擔部分 |
| D02 | 健保費 | 免稅減項 | 依健保計算規則 | 含眷屬保費 |
| D03 | 福利金 | 免稅減項 | 薪資 × 0.5% | 依公司規定 |
| D04 | 請假扣款 | 應稅減項 | 依請假扣薪規則 | 依請假類型不同計算方式不同 |
| D05 | 退休金自提 | 免稅減項 | 個人指定提撥比例 | 最高 6% |
| D06 | 所得稅 | 免稅減項 | 依所得稅計算規則 | 依稅率計算 |
| D07 | 其他扣款 | 依項目而定 | 依實際金額 | 如：預支薪資、代扣款項等 |

## 8. 特殊情境處理

### 8.1 復職人員處理

- 當月復職者，薪資計算方式比照破月到職人員處理
- 復職日與月初為同一日者，視為全月在職
- 當月復職又離職者，以離職日減復職日加 1 為實際在職天數

### 8.2 留職停薪人員處理

- 留職停薪期間不計薪資
- 留職停薪期間勞健保處理依法規規定

### 8.3 年中薪資調整處理

- 薪資調整生效日為每月 1 日
- 年中調薪時，以新薪資為基準計算當月薪資
- 相關加項和減項按新薪資級距重新計算

### 8.4 津貼追溯處理

- 追溯發放的津貼併入發放當月計算所得稅
- 跨年度追溯發放的津貼列入發放年度的所得

## 9. 特殊獎金處理

### 9.1 年終獎金計算

年終獎金基本計算公式：
```
年終獎金 = 基本薪資 × 發放月數 × 績效調整係數 × 在職比例
```

在職比例計算：
```
在職比例 = 當年度實際在職天數 ÷ 365(366)
```

### 9.2 各類獎金稅務處理

- 年終獎金：併入發放當月薪資計算所得稅
- 績效獎金：併入發放當月薪資計算所得稅
- 特殊獎金：依稅務規定處理（如：轉讓限制股票、股票選擇權等）

## 10. 系統計算邏輯流程

### 10.1 薪資計算主流程

1. 確認計薪年月和期別
2. 載入員工基本資料
3. 基本薪資計算（處理破月情況）
4. 計算加班費
5. 計算請假扣薪
6. 計算勞健保費用
7. 計算其他津貼和扣款
8. 計算所得稅
9. 計算合計金額
10. 儲存計算結果

### 10.2 系統參數與計算常數

| 參數名稱 | 參數值 | 說明 |
|----------|--------|------|
| 勞保費率 | 11% | 依政府公告調整 |
| 健保費率 | 5.17% | 依政府公告調整 |
| 計薪基數天數 | 30 天 | 標準月份計薪天數 |
| 眷屬健保費比例 | 0.7 | 每名眷屬健保費計算比例 |
| 福利金比例 | 0.5% | 薪資乘以比例計算 |
| 加班費時薪基數 | 月薪 ÷ 240 | 加班費計算基礎 |
| 平日加班倍率(前2小時) | 1.33 | 加班費計算倍率 |
| 平日加班倍率(後續時數) | 1.66 | 加班費計算倍率 |
| 休息日加班倍率 | 1.33/1.66 | 加班費計算倍率 |
| 例假日加班倍率 | 2.0 | 加班費計算倍率 |
``` 