# 泛太總帳系統 - 程式清單與規格書進度追蹤

## 總帳模組程式清單

### 主要畫面程式

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| GLA.master | 主版面 | 11KB | 245 | 系統主版面配置 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLA.master.cs | 主版面程式碼 | 14KB | 397 | 主版面後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLADetail.master | 細節版面 | 10KB | 218 | 系統細節版面配置 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLADetail.master.cs | 細節版面程式碼 | 2.3KB | 37 | 細節版面後端邏輯 | 低 | 已完成 | Claude AI | 2025/5/6 |
| Default.aspx | 預設首頁 | 431B | 17 | 系統預設首頁 | 低 | 已完成 | Claude AI | 2025/5/6 |
| Default.aspx.cs | 預設首頁程式碼 | 354B | 14 | 預設首頁後端邏輯 | 低 | 已完成 | Claude AI | 2025/5/6 |
| AuthAD.aspx | AD認證 | 6.2KB | 135 | Active Directory認證頁面 | 中 | 已完成 | Claude AI | 2025/5/6 |
| AuthAD.aspx.cs | AD認證程式碼 | 10KB | 249 | AD認證後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| AppErrorMessage.aspx | 錯誤訊息 | 555B | 9 | 系統錯誤訊息頁面 | 低 | 已完成 | Claude AI | 2025/5/6 |
| AppErrorMessage.aspx.cs | 錯誤訊息程式碼 | 1.5KB | 48 | 錯誤訊息後端邏輯 | 低 | 已完成 | Claude AI | 2025/5/6 |

### 交易處理程式

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| PTA0150 | 會計科目維護 | 8.7KB | 138 | 科目基本資料維護 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0150.aspx.cs | 會計科目維護程式碼 | 14KB | 381 | 科目維護後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0150_M | 會計科目查詢 | 9.3KB | 233 | 科目基本資料查詢 | 中 | 已完成 | Claude AI | 2025/5/6 |
| PTA0150_M.aspx.cs | 會計科目查詢程式碼 | 26KB | 785 | 科目查詢後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0160 | 部門資料維護 | 8.3KB | 133 | 部門基本資料維護 | 中 | 已完成 | Claude AI | 2025/5/6 |
| PTA0160.aspx.cs | 部門資料維護程式碼 | 14KB | 389 | 部門維護後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| PTA0160_M | 部門資料查詢 | 7.7KB | 190 | 部門基本資料查詢 | 中 | 已完成 | Claude AI | 2025/5/6 |
| PTA0160_M.aspx.cs | 部門資料查詢程式碼 | 20KB | 610 | 部門查詢後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0170 | 總帳交易維護 | 8.9KB | 141 | 傳票基本資料維護 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0170.aspx.cs | 總帳交易維護程式碼 | 14KB | 390 | 傳票維護後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0170_M | 總帳交易查詢 | 8.5KB | 197 | 傳票基本資料查詢 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PTA0170_M.aspx.cs | 總帳交易查詢程式碼 | 23KB | 723 | 傳票查詢後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |

### 報表程式

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| GLR0150 | 總帳報表 | 32KB | ~50 | 總帳基本報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0150.aspx.cs | 總帳報表程式碼 | 15KB | ~300 | 總帳報表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0160 | 會計科目查詢 | 10KB | ~100 | 會計科目報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0160.aspx.cs | 會計科目查詢程式碼 | 18KB | ~400 | 科目報表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR01G0 | 部門查詢 | 5.5KB | ~80 | 部門資料報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR01G0.aspx.cs | 部門查詢程式碼 | 6.0KB | ~200 | 部門報表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR01H0 | 傳票查詢 | 5.3KB | ~100 | 傳票資料報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR01H0.aspx.cs | 傳票查詢程式碼 | 7.8KB | ~250 | 傳票報表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR01J0 | 現金流量表 | 7.5KB | ~150 | 現金流量報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR01J0.aspx.cs | 現金流量表程式碼 | 12KB | ~300 | 現金流量表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0210 | 總帳明細報表 | 5.2KB | ~100 | 總帳明細報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0210.aspx.cs | 總帳明細報表程式碼 | 10KB | ~250 | 總帳明細報表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0220 | 餘額試算表 | 5.9KB | ~120 | 餘額試算報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0220.aspx.cs | 餘額試算表程式碼 | 9.5KB | ~300 | 餘額試算表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0230 | 損益表 | 6.6KB | ~130 | 損益報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0230.aspx.cs | 損益表程式碼 | 11KB | ~280 | 損益表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0240 | 資產負債表 | 6.0KB | ~120 | 資產負債報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0240.aspx.cs | 資產負債表程式碼 | 12KB | ~300 | 資產負債表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0250 | 部門損益表 | 5.2KB | ~100 | 部門損益報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0250.aspx.cs | 部門損益表程式碼 | 8.5KB | ~250 | 部門損益表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0260 | 現金日報表 | 6.5KB | ~130 | 現金收支報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0260.aspx.cs | 現金日報表程式碼 | 9.6KB | ~250 | 現金日報表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0270 | 銀行存款日報表 | 6.5KB | ~130 | 銀行存款報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0270.aspx.cs | 銀行存款日報表程式碼 | 9.6KB | ~250 | 銀行存款日報表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR02A0 | 會計報表 | 6.6KB | ~130 | 綜合會計報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR02A0.aspx.cs | 會計報表程式碼 | 12KB | ~300 | 會計報表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR02B0 | 預算差異分析表 | 3.2KB | ~60 | 預算差異報表 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR02B0.aspx.cs | 預算差異分析表程式碼 | 6.2KB | ~190 | 預算差異分析表後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR02Q0 | 傳票列印 | 4.7KB | ~90 | 傳票列印報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR02Q0.aspx.cs | 傳票列印程式碼 | 8.9KB | ~260 | 傳票列印後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR02R0 | 科目對帳單 | 5.3KB | ~100 | 科目對帳報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR02R0.aspx.cs | 科目對帳單程式碼 | 9.8KB | ~300 | 科目對帳單後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0300 | 交易明細表 | 6.1KB | ~100 | 交易明細報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0300.aspx.cs | 交易明細表程式碼 | 11KB | ~330 | 交易明細表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0310 | 交易彙總表 | 6.1KB | ~100 | 交易彙總報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0310.aspx.cs | 交易彙總表程式碼 | 11KB | ~330 | 交易彙總表後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0320 | 總分類帳 | 7.4KB | ~140 | 總分類帳報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0320.aspx.cs | 總分類帳程式碼 | 15KB | ~410 | 總分類帳後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| GLR0330 | 明細分類帳 | 4.2KB | ~90 | 明細分類帳報表 | 中 | 已完成 | Claude AI | 2025/5/6 |
| GLR0330.aspx.cs | 明細分類帳程式碼 | 9.5KB | ~310 | 明細分類帳後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |

### 使用者控制項

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| CalendarDate | 日期控制項 | 1.7KB | ~50 | 提供日期選擇功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarDate.ascx.cs | 日期控制項程式碼 | 7.2KB | ~250 | 日期選擇後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarDay | 日控制項 | 1.8KB | ~50 | 提供日選擇功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarDay.ascx.cs | 日控制項程式碼 | 5.3KB | ~180 | 日選擇後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarMonth | 月份控制項 | 1.4KB | ~40 | 提供月份選擇功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarMonth.ascx.cs | 月份控制項程式碼 | 8.4KB | ~280 | 月份選擇後端邏輯 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CalendarWeek | 週控制項 | 1.4KB | ~40 | 提供週選擇功能 | 中 | 未開始 | | |
| CalendarWeek.ascx.cs | 週控制項程式碼 | 14KB | ~400 | 週選擇後端邏輯 | 高 | 未開始 | | |
| CheckAuthorization | 權限檢查 | 640B | ~20 | 檢查使用者權限 | 中 | 已完成 | Claude AI | 2025/5/6 |
| CheckAuthorization.ascx.cs | 權限檢查程式碼 | 8.6KB | ~280 | 權限檢查後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| CodeList | 代碼清單 | 189B | ~5 | 提供代碼選擇功能 | 中 | 未開始 | | |
| CodeList.ascx.cs | 代碼清單程式碼 | 7.5KB | ~250 | 代碼選擇後端邏輯 | 中 | 未開始 | | |
| CompanyList | 公司清單 | 231B | ~5 | 提供公司選擇功能 | 低 | 未開始 | | |
| CompanyList.ascx.cs | 公司清單程式碼 | 4.4KB | ~150 | 公司選擇後端邏輯 | 中 | 未開始 | | |
| Navigator | 導航控制項 | 1.6KB | ~35 | 提供頁面導航功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| Navigator.ascx.cs | 導航控制項程式碼 | 8.9KB | ~310 | 頁面導航後端邏輯 | 高 | 已完成 | Claude AI | 2025/5/6 |
| PeriodList | 期間清單 | 191B | ~5 | 提供會計期間選擇 | 低 | 未開始 | | |
| PeriodList.ascx.cs | 期間清單程式碼 | 1.7KB | ~80 | 會計期間選擇後端邏輯 | 低 | 未開始 | | |
| SearchList | 搜尋清單 | 1.7KB | ~30 | 提供通用搜尋功能 | 高 | 未開始 | | |
| SearchList.ascx.cs | 搜尋清單程式碼 | 12KB | ~380 | 通用搜尋後端邏輯 | 高 | 未開始 | | |
| Subjects | 科目控制項 | 2.7KB | ~70 | 提供科目選擇功能 | 高 | 未開始 | | |
| Subjects.ascx.cs | 科目控制項程式碼 | 13KB | ~250 | 科目選擇後端邏輯 | 高 | 未開始 | | |
| YearList | 年度清單 | 477B | ~15 | 提供年度選擇功能 | 低 | 未開始 | | |
| YearList.ascx.cs | 年度清單程式碼 | 4.9KB | ~190 | 年度選擇後端邏輯 | 中 | 未開始 | | |

### 公用元件和服務

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| PopupDialog | 彈出對話框 | 2.1KB | 58 | 提供共用彈出視窗 | 中 | 未開始 | | |
| PopupDialog.aspx.cs | 彈出對話框程式碼 | 3.9KB | 125 | 彈出視窗後端邏輯 | 中 | 未開始 | | |
| ModelPopupDialog | 模態對話框 | 2.0KB | 51 | 提供共用模態視窗 | 中 | 未開始 | | |
| ModelPopupDialog.aspx.cs | 模態對話框程式碼 | 4.5KB | 139 | 模態視窗後端邏輯 | 中 | 未開始 | | |
| AppAuthority | 權限管理 | 15KB | 501 | 提供系統權限控制 | 高 | 已完成 | Claude AI | 2025/5/6 |
| CompanyManager | 公司資料管理 | 1.5KB | 64 | 管理公司基本資料 | 低 | 未開始 | | |
| GLA0110TManager | 交易管理 | 25KB | 890 | 提供交易處理功能 | 高 | 未開始 | | |
| LoginClass | 登入模組 | 21KB | 640 | 提供系統登入功能 | 高 | 已完成 | Claude AI | 2025/5/6 |
| Page_BaseClass | 頁面基底類別 | 4.2KB | 165 | 提供頁面共用功能 | 中 | 未開始 | | |
| UC_UserManager | 使用者管理 | 13KB | 485 | 提供使用者管理功能 | 高 | 未開始 | | |
| WSAutoComplete | 自動完成服務 | 20KB | 630 | 提供自動完成功能 | 高 | 未開始 | | |
| WSAutoComplete.asmx | 自動完成服務介面 | 101B | 2 | 自動完成Web服務介面 | 低 | 未開始 | | |
| WSFlowSignManager | 流程簽核管理 | 26KB | 738 | 提供簽核流程功能 | 高 | 未開始 | | |
| WSFlowSignJson.asmx | 流程簽核服務介面 | 101B | 2 | 流程簽核Web服務介面 | 低 | 未開始 | | |
| ExcelManger | Excel管理 | 30KB | 699 | 提供Excel匯出功能 | 高 | 未開始 | | |
| WSGLAcctDefJson | 科目定義服務 | 1.6KB | 49 | 提供科目定義功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| WSGLAcctDefJson.asmx | 科目定義服務介面 | 103B | 2 | 科目定義Web服務介面 | 低 | 未開始 | | |
| WSDialogData | 對話框資料服務 | 1.6KB | 52 | 提供對話框資料功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| WSDialogData.asmx | 對話框資料服務介面 | 97B | 2 | 對話框資料Web服務介面 | 低 | 未開始 | | |
| WSDialogData_Table | 對話框表格服務 | 1.1KB | 41 | 提供對話框表格功能 | 中 | 已完成 | Claude AI | 2025/5/6 |
| WSDialogData_Table.asmx | 對話框表格服務介面 | 109B | 2 | 對話框表格Web服務介面 | 低 | 未開始 | | |
| WSDialogData_Exception | 對話框例外服務 | 1.7KB | 50 | 提供對話框例外功能 | 中 | 未開始 | | |
| WSDialogData_Exception.asmx | 對話框例外服務介面 | 117B | 2 | 對話框例外Web服務介面 | 低 | 未開始 | | |

### 用戶端腳本

| 程式代號 | 程式名稱 | 檔案大小 | 行數 | 功能簡述 | 複雜度 | 規格書狀態 | 負責人員 | 完成日期 |
|---------|---------|---------|------|---------|---------|----------|---------|---------|
| pagefunction.js | 頁面函數 | 20KB | 527 | 提供頁面共用功能 | 高 | 未開始 | | |
| ModPopFunction.js | 彈出窗口函數 | 2.6KB | 82 | 提供彈出窗口控制 | 中 | 未開始 | | |
| Busy.js | 忙碌指示器 | 2.4KB | 51 | 提供忙碌狀態顯示 | 低 | 未開始 | | |
| InvSysFunction.js | 庫存系統函數 | 2.9KB | 77 | 提供庫存系統功能 | 中 | 未開始 | | |
| FASysFunc.js | 固定資產函數 | 7.8KB | 213 | 提供固定資產功能 | 高 | 未開始 | | |

## 程式相互關聯分析

### 核心程式依賴關係

```
GLA.master (系統主版面)
 ├── GLA.master.cs
 ├── CheckAuthorization (權限檢查)
 ├── pagefunction.js (頁面共用函數)
 └── LoginClass (登入模組)

PTA0170 (總帳交易維護)
 ├── PTA0170.aspx.cs
 ├── Page_BaseClass (頁面基底類別)
 ├── GLA0110TManager (交易管理)
 ├── WSAutoComplete (自動完成服務)
 ├── Subjects (科目控制項)
 ├── YearList (年度清單)
 └── PeriodList (期間清單)

GLR0220 (餘額試算表)
 ├── GLR0220.aspx.cs
 ├── Page_BaseClass (頁面基底類別)
 ├── ExcelManger (Excel管理)
 ├── YearList (年度清單)
 └── PeriodList (期間清單)
```

### 技術相依關係

1. **ASP.NET 架構相依**
   - 所有 `.aspx` 和 `.ascx` 文件依賴 ASP.NET 4.0 框架
   - 所有 `.master` 文件提供版面配置給其他頁面

2. **資料庫存取相依**
   - 所有資料存取相關程式依賴 `IBosDB.cs` 進行資料庫連接
   - 交易處理程式依賴 `GLA0110TManager` 進行資料存取與處理

3. **UI元件相依**
   - 報表程式依賴 `

## 規格書撰寫進度追蹤

| 完成狀態 | 數量 | 百分比 |
|---------|------|-------|
| 已完成   | 57   | 54.3% |
| 進行中   | 0    | 0%    |
| 未開始   | 48   | 45.7% |
| 總計     | 105  | 100%  |

## 風險評估與技術債務